const chai = require('chai')
const expect = chai.expect

const cveMiddleware = require('../../../src/controller/cve.controller/cve.middleware')
const rejectedBody = require('../../../test-http/src/test/cve_tests/cve_record_fixtures/rejectBody.json')
const multipleEngDescriptions = require('../../../test-http/src/test/cve_tests/cve_record_fixtures/rejectBodyMultipleSameEngValues.json')

describe('Testing the uniqueEnglishDescription middleware', () => {
  context('Negative Tests', function () {
    it('Submit a reject request with multiple English descriptions', function (done) {
      const result = cveMiddleware.uniqueEnglishDescription(multipleEngDescriptions.cnaContainer.rejectedReasons)
      expect(result).to.be.false
      done()
    })
  })

  context('Positive Tests', () => {
    it('Submit a reject request with single English descriptions', function (done) {
      const result = cveMiddleware.uniqueEnglishDescription(rejectedBody.cnaContainer.rejectedReasons)
      expect(result).to.be.true
      done()
    })
  })
})
