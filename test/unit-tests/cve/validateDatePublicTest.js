/* eslint-disable no-unused-expressions */

const chai = require('chai')
const expect = chai.expect

const { datePublicHelper } = require('../../../src/controller/cve.controller/cve.middleware')
const validDatePublicRecord = require('../../schemas/5.0/CVE-2017-4024_published.json')
const inValidDatePublicRecord = require('../../schemas/5.0/CVE-2017-4024_published_bad_datePublic.json')

describe('Testing validateDatePublic middleware', () => {
  context('Negative Tests', () => {
    it('Should throw an error for datePublic dates in the future ', async () => {
      const result = datePublicHelper(inValidDatePublicRecord.containers.cna.datePublic)
      expect(result).to.be.false
    })
  })

  context('Positive Tests', () => {
    it('Should return true for records with datePublic in the past', async () => {
      const result = datePublicHelper(validDatePublicRecord.containers.cna.datePublic)
      expect(result).to.be.true
    })
  })
})
