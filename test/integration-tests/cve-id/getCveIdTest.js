/* eslint-disable no-unused-expressions */

const chai = require('chai')
chai.use(require('chai-http'))

const expect = chai.expect

const constants = require('../constants.js')
const app = require('../../../src/index.js')

describe('Testing Get CVE-ID endpoint', () => {
  context('Positive Tests', () => {
    it('Get CVE-ID should return everything when no parameters are specifed', async () => {
      await chai.request(app)
        .get('/api/cve-id')
        .set(constants.headers)
        .then((res, err) => {
          expect(err).to.be.undefined
          expect(res).to.have.status(200)
        })
    })
    it('Get CVE-ID should return an empty array when time modified is set to a very far future date', async () => {
      await chai.request(app)
        .get('/api/cve-id?time_modified.gt=2100-01-01T00:00:00')
        .set(constants.headers)
        .then((res, err) => {
          expect(err).to.be.undefined
          expect(res).to.have.status(200)
          expect(res.body.cve_ids).to.have.length(0)
        })
    })
  })
})
