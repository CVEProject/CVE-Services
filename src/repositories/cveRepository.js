const BaseRepository = require('./baseRepository')
const Cve = require('../model/cve')

class CveRepository extends BaseRepository {
  constructor () {
    super(Cve)
  }

  async findOneByCveId (id) {
    const results = this.collection.findOne().byCveId(id)
    return results
  }

  async updateByCveId (id, cve, options = {}) {
    return this.collection.findOneAndUpdate().byCveId(id).updateOne(cve).setOptions(options)
  }

  async cursorPaginate (query, limit, next, previous) {
    return this.collection.paginate({ query, limit: Number(limit), previous, next, paginatedField: 'time.created' })
  }
}

module.exports = CveRepository
