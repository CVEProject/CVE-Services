const mongoose = require('mongoose')

const CveSchema = new mongoose.Schema({
  _id: false,
  cve: Object
}, { collection: 'Cve' })

CveSchema.query.byCveId = function (cveId) {
  return this.where({ 'cve.CVE_data_meta.ID': new RegExp('^' + cveId + '$', 'i') }) // match cveId exactly (case insensitive)
}

const Cve = mongoose.model('Cve', CveSchema)

module.exports = Cve
