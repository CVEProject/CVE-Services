import * as NodeRSA from 'node-rsa';

/**
 * Uploads data to AWS bucket
 * @param {string} payload - Payload contents
 * @param {string} signature - Signature for payload
 * @param {string} publicKey - Public key stored in system
 * @returns {boolean} - Is verified or not
 */
export function verifySignature(payload: string, signature: string, publicKey: string): Boolean {
    let serverNodeRsa = new NodeRSA(publicKey);
    serverNodeRsa.setOptions({ signingScheme: process.env.RSASigningSchema });
    return serverNodeRsa.verify(payload, signature, null, 'hex') as boolean;
}
